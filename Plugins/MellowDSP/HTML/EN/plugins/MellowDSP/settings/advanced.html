[% PROCESS settings/header.html %]

<h2>MellowDSP - Advanced Settings</h2>

[% WRAPPER setting title="Enable MellowDSP Globally" desc="Master switch for the entire MellowDSP system" %]
    <input name="pref_enabled" type="checkbox" [% IF prefs.enabled %] checked [% END %]>
    <label for="pref_enabled">Enable MellowDSP System</label>
[% END %]

<hr>

[% WRAPPER setting title="Helper Applications" desc="Paths to required audio processing tools" %]

[% END %]

[% WRAPPER setting title="SOX" desc="Audio processing and resampling engine" %]
    <input type="text" name="pref_sox_path" value="[% prefs.sox_path %]" size="50">
    [% IF prefs.sox_exists %]
        <span style="color:green;">✓ Found</span>
    [% ELSE %]
        <span style="color:red;">✗ Not found</span>
    [% END %]
[% END %]

[% WRAPPER setting title="FFMPEG" desc="Additional audio format support" %]
    <input type="text" name="pref_ffmpeg_path" value="[% prefs.ffmpeg_path %]" size="50">
    [% IF prefs.ffmpeg_exists %]
        <span style="color:green;">✓ Found</span>
    [% ELSE %]
        <span style="color:red;">✗ Not found</span>
    [% END %]
[% END %]

[% WRAPPER setting title="SOX Buffer Size" desc="Buffer size in KB for SOX processing" %]
    <select name="pref_buffer_size">
        <option value="4" [% IF prefs.buffer_size == '4' %]selected[% END %]>4 KB</option>
        <option value="8" [% IF prefs.buffer_size == '8' %]selected[% END %]>8 KB (Default)</option>
        <option value="16" [% IF prefs.buffer_size == '16' %]selected[% END %]>16 KB</option>
        <option value="32" [% IF prefs.buffer_size == '32' %]selected[% END %]>32 KB</option>
    </select>
[% END %]

<hr>

[% WRAPPER setting title="System Information" desc="" %]
    <div style="background:#f8f8f8; padding:15px; border-radius:5px;">
        <strong>MellowDSP Processing Pipeline:</strong><br><br>
        
        <strong>1. Input Processing:</strong><br>
        • Supported formats: AIFF, Apple Lossless, FLAC, WAV<br>
        • Player-specific format selection<br><br>
        
        <strong>2. SOX Transcoding:</strong><br>
        • High-quality resampling with configurable phase response<br>
        • Upsampling to target sample rate (up to 768 kHz)<br>
        • 24-bit output depth<br><br>
        
        <strong>3. FIR Filtering:</strong><br>
        • Automatic resampling of REW filters to match target rate<br>
        • Separate left/right channel correction<br>
        • Dynamic filter conversion when settings change<br><br>
        
        <strong>4. Output:</strong><br>
        • WAV uncompressed PCM format<br>
        • Player-specific supported sample rates<br>
        • Professional audio quality
    </div>
[% END %]

[% PROCESS settings/footer.html %]
