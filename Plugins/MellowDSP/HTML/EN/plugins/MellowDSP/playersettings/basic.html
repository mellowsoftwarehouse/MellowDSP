[% PROCESS settings/header.html %]

<h2>MellowDSP - Player Settings: [% client_name %]</h2>

[% WRAPPER setting title="Enable MellowDSP for this player" desc="Master switch for MellowDSP processing on this specific player" %]
    <input name="pref_player_enabled" type="checkbox" [% IF prefs.player_enabled %] checked [% END %]>
[% END %]

<hr>

[% WRAPPER setting title="Input Formats" desc="Audio formats to process with MellowDSP" %]
    <input name="pref_input_aiff" type="checkbox" [% IF prefs.input_aiff %] checked [% END %]>
    <label for="pref_input_aiff">AIFF</label>&nbsp;&nbsp;
    
    <input name="pref_input_alac" type="checkbox" [% IF prefs.input_alac %] checked [% END %]>
    <label for="pref_input_alac">Apple Lossless</label>&nbsp;&nbsp;
    
    <input name="pref_input_flac" type="checkbox" [% IF prefs.input_flac %] checked [% END %]>
    <label for="pref_input_flac">FLAC</label>&nbsp;&nbsp;
    
    <input name="pref_input_wav" type="checkbox" [% IF prefs.input_wav %] checked [% END %]>
    <label for="pref_input_wav">WAV</label>
[% END %]

[% WRAPPER setting title="Max PCM Sample Rate" desc="Maximum sample rate this player can handle" %]
    <select name="pref_max_pcm_rate">
        <option value="48000" [% IF prefs.max_pcm_rate == '48000' %]selected[% END %]>48 kHz</option>
        <option value="96000" [% IF prefs.max_pcm_rate == '96000' %]selected[% END %]>96 kHz</option>
        <option value="192000" [% IF prefs.max_pcm_rate == '192000' %]selected[% END %]>192 kHz</option>
        <option value="384000" [% IF prefs.max_pcm_rate == '384000' %]selected[% END %]>384 kHz</option>
        <option value="768000" [% IF prefs.max_pcm_rate == '768000' %]selected[% END %]>768 kHz</option>
    </select>
[% END %]

[% WRAPPER setting title="Output Sample Rates" desc="Supported output sample rates for transcoding" %]
    <input name="pref_output_44100" type="checkbox" [% IF prefs.output_44100 %] checked [% END %]>
    <label>44.1 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_48000" type="checkbox" [% IF prefs.output_48000 %] checked [% END %]>
    <label>48 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_88200" type="checkbox" [% IF prefs.output_88200 %] checked [% END %]>
    <label>88.2 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_96000" type="checkbox" [% IF prefs.output_96000 %] checked [% END %]>
    <label>96 kHz</label><br>
    
    <input name="pref_output_176400" type="checkbox" [% IF prefs.output_176400 %] checked [% END %]>
    <label>176.4 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_192000" type="checkbox" [% IF prefs.output_192000 %] checked [% END %]>
    <label>192 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_352800" type="checkbox" [% IF prefs.output_352800 %] checked [% END %]>
    <label>352.8 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_384000" type="checkbox" [% IF prefs.output_384000 %] checked [% END %]>
    <label>384 kHz</label><br>
    
    <input name="pref_output_705600" type="checkbox" [% IF prefs.output_705600 %] checked [% END %]>
    <label>705.6 kHz</label>&nbsp;&nbsp;
    
    <input name="pref_output_768000" type="checkbox" [% IF prefs.output_768000 %] checked [% END %]>
    <label>768 kHz</label>
[% END %]

[% WRAPPER setting title="Target Sample Rate" desc="Primary upsampling target for this player" %]
    <select name="pref_target_rate">
        <option value="44100" [% IF prefs.target_rate == '44100' %]selected[% END %]>44.1 kHz (No upsampling)</option>
        <option value="88200" [% IF prefs.target_rate == '88200' %]selected[% END %]>88.2 kHz</option>
        <option value="176400" [% IF prefs.target_rate == '176400' %]selected[% END %]>176.4 kHz</option>
        <option value="352800" [% IF prefs.target_rate == '352800' %]selected[% END %]>352.8 kHz</option>
        <option value="705600" [% IF prefs.target_rate == '705600' %]selected[% END %]>705.6 kHz</option>
        <option value="768000" [% IF prefs.target_rate == '768000' %]selected[% END %]>768 kHz</option>
    </select>
[% END %]

[% WRAPPER setting title="Phase Response" desc="Resampling phase characteristics" %]
    <select name="pref_phase_response">
        <option value="linear" [% IF prefs.phase_response == 'linear' %]selected[% END %]>Linear Phase (Highest Quality)</option>
        <option value="intermediate" [% IF prefs.phase_response == 'intermediate' %]selected[% END %]>Intermediate Phase</option>
        <option value="minimum" [% IF prefs.phase_response == 'minimum' %]selected[% END %]>Minimum Phase</option>
    </select>
[% END %]

<hr>

[% WRAPPER setting title="FIR Filters" desc="Room correction filters from REW measurements" %]
    <input name="pref_fir_enabled" type="checkbox" [% IF prefs.fir_enabled %] checked [% END %]>
    <label for="pref_fir_enabled">Enable FIR Filtering</label>
[% END %]

[% WRAPPER setting title="Left Channel FIR Filter" desc="WAV file from REW for left channel room correction" %]
    <input type="text" name="pref_fir_left" value="[% prefs.fir_left %]" size="60" placeholder="/path/to/left_channel_fir.wav">
    <br><small>Full path to WAV file generated by REW for left channel FIR filter</small>
[% END %]

[% WRAPPER setting title="Right Channel FIR Filter" desc="WAV file from REW for right channel room correction" %]
    <input type="text" name="pref_fir_right" value="[% prefs.fir_right %]" size="60" placeholder="/path/to/right_channel_fir.wav">
    <br><small>Full path to WAV file generated by REW for right channel FIR filter</small>
[% END %]

[% WRAPPER setting title="FIR Processing Info" desc="" %]
    <div style="background:#f0f8ff; padding:10px; border-radius:5px; font-size:12px;">
        <strong>Automatic FIR Resampling:</strong><br>
        • Master FIR files are stored at original REW frequency<br>
        • FIR filters automatically resampled to match target sample rate<br>
        • When target rate changes, FIR filters are re-converted from masters<br>
        • Processing: Audio upsampling → FIR filtering → Output
    </div>
[% END %]

[% PROCESS settings/footer.html %]
